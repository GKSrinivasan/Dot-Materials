function additionalParam(){return{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}function grdApprovalDataBound(){var n=$("#grdApprovalData").data("kendoGrid");n._data.length==0?($("#ApprovalData").hide(),$("#gridHeaderTxt").hide()):($("#ApprovalData").show(),$("#gridHeaderTxt").show())}function setRowChanged(n){n.IsChanged=!0}function onWorkFlowPageLoad(){IsWorkFlowDataCustomized=="True"?($("#customBtn").prop("checked",!0),$("#uploadWfDataTab").show(),$("#btnSave").show(),$("[id*=deleteBtn]").show(),$("[id*=AppMgr]").show(),$("#wrkflwlevel").hide()):($("#customBtn").prop("checked",!1),$("#uploadWfDataTab").hide(),$("#btnSave").hide(),$("[id*=deleteBtn]").hide(),$("[id*=AppMgr]").hide(),$("#wrkflwlevel").show())}function checkValid(n,t){return n==""||n==""?isValid=!0:n==t?(Warningmessage("Cannot assign Employee"),isValid=!1):(index=$.inArray(n,arr_ids),index!=-1?isValid=!0:(Warningmessage("Invalid ManagerID"),isValid=!1)),isValid}function AdditionalParameterInfo(){var n=$("#ddlProcess").data("kendoDropDownList");return{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val(),ProcessNum:defaultProcessNum}}function grdData(n,t){var r=$("input:radio[name=empShow]:checked").val(),u=$("input:radio[name=CustomizeBtn]:checked").val(),i;return u=="Custom"&&r=="EmployeeID"?(i=n["EmpID_"+t],i=="FALSE"&&t!=1?$(".disableBtn"+t).attr("disabled",!0):i!="FALSE"&&t!=1?$(".disableBtn"+t).removeAttr("disabled",!0):"",(i==null||i=="FALSE")&&(i=""),'<input id="txt_'+t+'" type="text" value="'+i+'" onkeypress = "return ValidateAllTextBoxes(event);" />'):(i=r=="EmployeeName"?n["EmpName_"+t]:n["EmpID_"+t],(i==null||i=="FALSE")&&(i=""),i)}function ddlProcessDataBound(){$("#ddlProcess").data("kendoDropDownList").select(function(n){return n.Value==defaultProcessNum})}function downloadApprovalData(){var n=$("<form action='../Workflow/GetApprovalDataTemplate' method='post'><\/form>");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()}function getFileIconUsingMIME(n){return n.match("image")=="image"?"fa-file-image-o":n.match("word")=="word"?"fa-file-word-o":n.match("excel")=="excel"?"fa-file-excel-o":n.match("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?"fa-file-excel-o":n.match("powerpoint")=="powerpoint"?"fa-file-powerpoint-o":n.match("pdf")=="pdf"?"fa-file-pdf-o":n.match("text")=="text"?"fa-file-text-o":"fa-file-o"}function getFileSizeUsingBytes(n){var t;return n>=1048576?Math.round(n/1048576)+" MB)":n<=1048576&&n>=1024?Math.round(n/1024)+"KB":n<=1024?Math.round(n)+"Bytes":Math.round(n/1073741824)+"GB"}function getApprovalDataErrorList(){$.ajax({url:"../Workflow/_GetApprovalDataErrorList",type:"GET",async:!1,contentType:"application/json",processData:!1,success:function(n){$("#approvalData-Error").html(n);$("#approvalData-Error").modal("show");$("#approvalDataerrorFiles").html($("#errorFiles").html())}})}function LevelChanged(){var n;removeItem();n=$("#grdWorkFlow").data("kendoGrid");n.dataSource._filter!=undefined&&(clearFilterSort(!0),$("#btnClearFilter").hide(),$("#filter").show());var t=$("#ddlProcess").val(),i=$("#ddlWFLevels").val(),r=$('input[name="__RequestVerificationToken"]').val();if(t)i!=""&&$.ajax({url:"../WorkFlow/ReloadGrid",type:"post",data:{__RequestVerificationToken:r,processNum:t,Level:i,LevelBasedWFData:LevelBasedWFData},success:function(t){objChangeFlag=!1;$("#uploadWfDataTab").hide();$("#btnSave").hide();$("[id*=deleteBtn]").hide();$("[id*=AppMgr]").hide();$("#employeeID").prop("checked",!0);$("#wrkflwlevel").show();n.dataSource.read();Successmessage(t)}});else return $("#customBtn").prop("checked",!0),!1}function getApprovalErrorExport(){var n=$("<form action='../Workflow/GetApprovalDataErrorExport' method='post'><\/form>");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()}function GetWorkFlowErrorCount(){$.ajax({url:"../Workflow/GetWorkFlowDataErrorCount",type:"POST",data:{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()},success:function(n){n>0||isErrorTemplate==!0?(getApprovalDataErrorList(),n>0&&$("#workflowErrorListLink").show(),isErrorTemplate=!1):$("#workflowErrorListLink").hide()}})}function ValidateAllTextBoxes(n){var t=new RegExp("^[a-zA-Z0-9]+$"),i=String.fromCharCode(n.charCode?n.charCode:n.which);if(!t.test(i))return n.preventDefault(),!1}function grdApprovalErrorRecordDataBound(){var n=$("#grdApprovalDataError").data("kendoGrid");n._data.length==0?$("#divUserDataError").hide():$("#divUserDataError").show()}function WorkFlowGridDataBound(){var t=$("#grdWorkFlow").data("kendoGrid"),n;t.dataSource._data.length==0&&(n=$("#grdWorkFlow").find("th").length,$("#grdWorkFlow").find("tbody").append('<tr class="kendo-data-row"><td colspan="'+n+'" style="text-align:center;background-color:#6686C4;color:white !important;><b style="background-color:#6686C4 !important;">No Results Found!<\/b><\/td><\/tr>'))}function removeItem(){var n=$("#ddlWFLevels").data("kendoDropDownList"),t=n.dataSource.data();n.setOptions({optionLabel:!1});n.refresh()}function addSelectItem(){var n=$("#ddlWFLevels").data("kendoDropDownList"),t=n.dataSource.data();n.setOptions({optionLabel:"-select-"});n.refresh()}var arr_ids=[],uploader,isErrorTemplate=!1,LevelBasedWFData=!0;$(document).ready(function(){$("#approvalDataProcess").attr("disabled",!0);$('[data-toggle="tooltip"]').tooltip();onWorkFlowPageLoad();$("#btnClearFilter").hide();uploader=new plupload.Uploader({runtimes:"html5",drop_element:"drop-zone",browse_button:"browsefiles",url:"../Upload",filters:{mime_types:[{title:"Image files",extensions:"xlx,xlsx"},],max_file_size:"10mb",prevent_duplicates:!0},dragdrop:!0,init:{FilesAdded:function(n,t){plupload.each(t,function(n){var t=$("<div class='file-area' id='"+n.id+"' data-fileid='"+n.rid+"'><div class='file-icon'><span class='fa "+getFileIconUsingMIME(n.type)+"'><\/span><\/div><div class='file-content'><div style='font-size:14px;'>"+n.name+"<\/div><div style='font-size:10px;'>"+getFileSizeUsingBytes(n.size)+"<\/div><div class='progress'><div class='progress-bar'  id = 'upload' role='progressbar' aria-valuenow='0' aria-valuemin='0' aria-valuemax='100' style='width:0%;'>0%<\/div><\/div><\/div><div class='file-remove'><span class='fa fa-times' data-fileid='"+n.id+"'><\/span><\/div> <\/div>");$("#divFileArea").append(t);uploader.files.length>0&&$("#approvalDataProcess").removeAttr("disabled")})},UploadProgress:function(n,t){var i=$("#"+t.id).find(".progress-bar"),r=t.percent<75?t.percent:75;i.css("width",r+"%");i.text(r+"%");i.attr("aria-valuenow",r)},BeforeUpload:function(n,t){if(uploader.total.uploaded==0){$("#errorFiles").children().remove();var i=$("#ajaxLoadingPanel");i.height($(window).height());i.width($(window).width());i.css("top",$(window).scrollTop());i.css("left",$(window).scrollLeft());i.show()}uploader.settings.multipart_params=uploader.total.uploaded+1==uploader.files.length?{isLastFile:"yes",__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}:{isLastFile:"",__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()};$("#"+t.id).find(".progress").show();$(".file-remove").find("#"+t.id).hide()},FileUploaded:function(n,t,i){var r,u,f;i=JSON.parse(i.response);i.Message!=""&&(r=$("#"+t.id).find(".progress-bar"),u=100,i.Message!="Uploaded successfully"&&i.Message!="Processed successfully"&&(Errormessage(i.Message),isErrorTemplate=!0,r.css("background-color","red"),i.Message=="Invalid format or Password protected"?(f="<div style='word-wrap: break-word;margin-left:2% !important;margin-right:2% !important;'><div class='row'>"+t.name+"<br/> Invalid format or Password protected<\/div><\/div><br/>",$("#errorFiles").append(f)):(f="<div style='word-wrap: break-word;margin-left:2% !important;margin-right:2% !important;'><div class='row'>"+t.name+"<br/>"+i.Message+" Columns mismatch with templateColumns mismatch with template<\/div><\/div><br/>",$("#errorFiles").append(f))),r.css("width",u+"%"),r.text(u+"%"),r.attr("aria-valuenow",u),Successmessage(i.Message))},UploadComplete:function(n){n.splice();$("#divFileArea").children().remove();GetWorkFlowErrorCount();$("#grdApprovalData").data("kendoGrid").dataSource.read();$("#ajaxLoadingPanel").hide()},Error:function(n,t){var i=$("#"+t.file.id).find(".progress-bar"),r=100;i.css("width",r+"%");i.text(r+"%");i.attr("aria-valuenow",r)}}});uploader.init();$(document).on("hide.bs.modal","#approvalData-Error",function(){$("#errorFiles").children().remove()});$(document).on("click","#approvalDataProcess",function(){return uploader.start(),!1});$(document).on("click",".file-remove .fa-times",function(){var n=$(this).data("fileid");uploader.removeFile(n);$(this).parents(".file-area").remove();uploader.files.length==0?$("#approvalDataProcess").attr("disabled",!0):$("#approvalDataProcess").removeAttr("disabled")});$(document).on("click","#customBtn",function(){$("#uploadWfDataTab").show();$("#btnSave").show();$("#employeeID").prop("checked",!0);$("[id*=deleteBtn]").show();$("[id*=AppMgr]").show();$("#wrkflwlevel").hide();var n=$("#grdWorkFlow").data("kendoGrid");n.dataSource._filter!=undefined&&(clearFilterSort(!0),$("#btnClearFilter").hide(),$("#filter").show());n.dataSource.read()});$(document).on("click","#hierarchyBtn",function(n){var t,r;if(addSelectItem(),!showSaveWarning(n,"objChangeFlag"))return n._defaultPrevented=!0,!1;LevelBasedWFData=!1;t=$("#grdWorkFlow").data("kendoGrid");t.dataSource._filter!=undefined&&(clearFilterSort(!0),$("#btnClearFilter").hide(),$("#filter").show());var i=$("#ddlProcess").val(),f=$("input:radio[name=CustomizeBtn]:checked").val(),u=$('input[name="__RequestVerificationToken"]').val();if(i)if(r=showConfirm(n,"You are about to make changes to Workflow configuration by loading current Org structure. Do you want to continue?  \n Press OK to reload. \n Press cancel to continue without reloading"),r)$.ajax({url:"../WorkFlow/ReloadGrid",type:"post",data:{__RequestVerificationToken:u,processNum:i,Level:0,LevelBasedWFData:LevelBasedWFData},success:function(n){objChangeFlag=!1;$("#uploadWfDataTab").hide();$("#btnSave").hide();$("[id*=deleteBtn]").hide();$("[id*=AppMgr]").hide();$("#employeeID").prop("checked",!0);$("#wrkflwlevel").show();t.dataSource.read();Successmessage(n);LevelBasedWFData=!0;$("#ddlWFLevels").data("kendoDropDownList").value(-1)}});else return $("#customBtn").prop("checked",!0),!1});$(document).on("click","[id$=btnDelete]",function(n){var t=$("#grdApprovalData").data("kendoGrid"),i=$(this).closest("tr"),r=$(i).index(),u=t._data[r],f=u.XMLProcessNum,e=$('input[name="__RequestVerificationToken"]').val(),o=showConfirm(n,"Do you want to delete?");if(o)$.ajax({url:"../Workflow/DeleteApprovalTemplateData",data:{__RequestVerificationToken:e,xmlProcessNum:f},type:"post",success:function(n){Successmessage(n);t.dataSource.read()}});else return!1});$(document).on("click","#employeeID",function(){var t=$("input:radio[name=CustomizeBtn]:checked").val(),n;t=="Custom"?($("[id*=deleteBtn]").show(),$("[id*=AppMgr]").show()):($("[id*=deleteBtn]").hide(),$("[id*=AppMgr]").hide());n=$("#grdWorkFlow").data("kendoGrid");n.dataSource.read()});$(document).on("click","#employeeName",function(n){if(!showSaveWarning(n,"objChangeFlag"))return n._defaultPrevented=!0,!1;$("[id*=deleteBtn]").hide();$("[id*=AppMgr]").hide();var t=$("#grdWorkFlow").data("kendoGrid");t.dataSource.read()});var n="";$(document).on("click","#lnkXmlApprovalFileName",function(){var t=$("#grdApprovalData").data("kendoGrid"),i=$(this).closest("tr"),r=$(i).index(),u=t._data[r],f=u.XMLProcessNum,n=$("<form action='../WorkFlow/GetExportXmlFile' method='post'><\/form>");n.append("<input type='text' name='xmlProcessNum' value='"+f+"' />");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()});$(document).on("click","#filter",function(){$("body").css("overflow","hidden");n=$("#employeeID").is(":checked")?"EmployeeID":"EmployeeName";$.ajax({url:"../Workflow/_FilterSort",type:"GET",cache:!1,data:{type:n},async:!0,dataType:"html",success:function(n){$("#wndFilterSort").html(n);var t=$("#wndFilterSort").data("kendoWindow");t.options.gridName="grdWorkFlow";t.center().open();$("#filterseperator").css("display","inline");isFilter=!0}})});$(document).on("click","#btnClearFilter",function(){clearFilterSort(!0);$("#btnClearFilter").hide();$("#filter").show()});$(document).on("click","[id*=deleteBtn]",function(n){var i=$("#grdWorkFlow").data("kendoGrid"),r=$(this)[0].id.replace("deleteBtn",""),u="AppMgr"+r+"EmpNum",f=$("#ddlProcess").val(),e=$(this)[0].value,o=i.dataSource._params(),t=i.dataSource.transport.parameterMap(o),s=$("input[name='__RequestVerificationToken']").val(),h=showConfirm(n,"Do you want to delete entire level"+r.toLowerCase()+" mangers?");h&&$.ajax({url:"../WorkFlow/CopyInWorkFlowGrid",type:"post",data:{__RequestVerificationToken:s,filter:t.filter,group:t.group,page:t.page,pageSize:t.pageSize,sort:t.sort,processNum:f,headerID:u,headerValue:e,actionStatus:"Delete"},success:function(n){var t=n?"Deleted successfully":"An error occurred while deleting record";objChangeFlag=!1;Successmessage(t);i.dataSource.read();i.dataSource._filter!=undefined&&$("#btnClearFilter").trigger("click")}})});$(document).on("change","[id *= idtxtbox1]",function(n){if(n.target.value=="")return n.preventDefault(),n.target.value=n.target.defaultValue,!1});$(document).on("click","#btnSave",function(n){var i=$("#grdWorkFlow").data("kendoGrid"),c=i.dataSource.data(),u,s,h;a=n.target.value;var f=$("#ddlProcess").data("kendoDropDownList"),l=f.dataItem(f.select()),e=$("#ddlProcess").val(),t="",r="",o=$("input[name='__RequestVerificationToken']").val();if($("[id*=AppMgr]").each(function(){$(this)[0].value!=""&&(r=r+","+$(this)[0].id,t=t+","+$(this)[0].value)}),u=[],$(c).each(function(n,t){t.IsChanged&&u.push(t)}),index=$.inArray(t.replace(",","").trim(),arr_ids),index==-1&&t!="")return Warningmessage("Invalid ManagerID"),!1;objChangeFlag&&(s=JSON.stringify(u),h=JSON.parse(s),$.ajax({url:"../WorkFlow/UpdateGridData",type:"post",data:{__RequestVerificationToken:o,workFlow:h,processNum:e,module:l.Text},success:function(n){if(t!=""&&r!=""){var f=i.dataSource._params(),u=i.dataSource.transport.parameterMap(f);$.ajax({url:"../WorkFlow/CopyInWorkFlowGrid",type:"post",data:{__RequestVerificationToken:o,filter:u.filter,group:u.group,page:u.page,pageSize:u.pageSize,sort:u.sort,processNum:e,headerID:r,headerValue:t,actionStatus:"Update"},success:function(n){var t=n?"Updated successfully":"An error occurred while saving record";Successmessage(t)}})}objChangeFlag=!1;i.dataSource.read();Successmessage(n);i.dataSource._filter!=undefined&&$("#btnClearFilter").trigger("click");$("[id*=AppMgr]").val("")}}))});$(document).on("click","#employeeListLnk",function(){$("#workflowSection").show();$("#btnSave").show();$("#dropdownMenu1").show()});$(document).on("click","#uploadWFData",function(){$("#workflowSection").hide();$("#btnSave").hide();$("#dropdownMenu1").hide()});$(document).on("change","[id*=txt_]",function(n){var i=$("#grdWorkFlow").data("kendoGrid"),r=$(this).closest("tr"),f=$(r).index(),t=i._data[f],e=i.dataItem(r),o=n.currentTarget.offsetParent.id,u;objChangeFlag=!0;switch(o){case"idtxtbox1":t.EmpID_1=n.target.value.trim();break;case"idtxtbox2":t.EmpID_2=n.target.value.trim();break;case"idtxtbox3":t.EmpID_3=n.target.value.trim();break;case"idtxtbox4":t.EmpID_4=n.target.value.trim();break;case"idtxtbox5":t.EmpID_5=n.target.value.trim();break;case"idtxtbox6":t.EmpID_6=n.target.value.trim();break;case"idtxtbox7":t.EmpID_7=n.target.value.trim();break;case"idtxtbox8":t.EmpID_8=n.target.value.trim();break;case"idtxtbox9":t.EmpID_9=n.target.value.trim();break;case"idtxtbox10":t.EmpID_10=n.target.value.trim()}u=checkValid(n.target.value.trim(),t.EmployeeID);u==!0&&setRowChanged(e)});$(document).on("focusout","#grdWorkFlow .k-header input[type='text']",function(n){objChangeFlag=!0;var t=!1;n.target.value.trim()==""||n.target.value.trim()==""?t=!0:(index=$.inArray(n.target.value.trim(),arr_ids),index!=-1?t=!0:(Warningmessage("Invalid ManagerID"),t=!1))});$(document).on("change","#grdWorkFlow .k-header input[type='text']",function(n){objChangeFlag=!0;var t=!1;n.target.value.trim()==""||n.target.value.trim()==""?t=!0:(index=$.inArray(n.target.value.trim(),arr_ids),index!=-1?t=!0:(Warningmessage("Invalid ManagerID"),t=!1))})});$(function(){$.getJSON("../WorkFlow/GetEmpId",function(n){var t=n;array_parsed=JSON.parse(t);$(array_parsed).each(function(){arr_ids.push(this.EmployeeID)})})});$(document).on("click","#btnWorkFlowExport",function(){var t=defaultProcessNum,n=$("<form action='../Workflow/GetExportGridData' method='post'><\/form>");n.append("<input type='text' name='moduleNum' value='"+t+"' />");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()});