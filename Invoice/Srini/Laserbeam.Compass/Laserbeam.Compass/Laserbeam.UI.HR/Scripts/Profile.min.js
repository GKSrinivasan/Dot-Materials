function getNumber(n){n=getNumberValue(n,"en-US");return isNaN(n)||n==null||n==undefined?0:n}function grdTaskDataBound(){var r=$("#TaskData").data("kendoGrid"),o,i,s;if($("#taskCount").html(r.dataSource._total),r._data.length>0){var h=r._data[0].TotalSpent,e=h.split(":"),u=e[0],n=e[1],t=hoursSpent-u,f=Math.abs(60-n);n>0&&(t=t-1);n==0&&(f=0);o=$("#hoursSpentPct")[0].innerHTML.replace("%","");i=(getNumber(u+"."+n)/hoursSpent*100).toFixed(0);$("#totalHrsSpent").html(u+":"+n);$("#availableHours").html(t+":"+f);$("#hoursSpentPct").html(i+"%");t<=0&&f<=0?$("#btnAddTask").attr("disabled",!0):$("#btnAddTask").attr("disabled",!1);s=Number(i)>100?100:i;$("#chart").removeClass("p"+o);$("#chart").addClass("p"+s)}}function saveSupportComment(n){var i=$("#commentEditBox_"+n).attr("data-commentLabel"),t;$("#IsEditItem").val(!0);t=$("#commentEditBox_"+n).val();$("#SupportTaskCommentsNum").val(n);$("#taskComment").text(t);$("#btnCmtEdit_"+n).show();$("#frmSupportTaskComment").submit()}function closeAfterCommentsSlide(){$("#divSupportTaskComments").modal("hide")}function teamchanged(){var n=$("#ddlTeamTitle");$(n).getKendoDropDownList().list.find("li.k-item").first().hide();$("#ddlTeamTitle").val()==""?$("#error_ddlTeamTitle").html("Team is missing"):$("#error_ddlTeamTitle").html("")}function teamchangedInEdit(){$("#ddlEditTeamTitle").val()==""?$("#errorEdit_ddlTeamTitleEdit").html("Team is missing"):$("#errorEdit_ddlTeamTitleEdit").html("")}function startDateChanged(){$("#addStartDate").val()==""||$("#addStartDate").val()==undefined?$("#error_startDate").html("StartDate is missing"):$("#error_startDate").html("")}function startDateEditValidation(){$("#startDate").val()==""||$("#startDate").val()==undefined?$("#errorEdit_startDateEdit").html("StartDate is missing"):$("#errorEdit_startDateEdit").html("")}function endDateChanged(){$("#addEndDate").val()==""||$("#addEndDate").val()==undefined?$("#error_endDate").html("endDate is missing"):$("#error_endDate").html("")}function endDateEditValidation(){$("#endDate").val()==""||$("#endDate").val()==undefined?$("#errorEdit_endDateEdit").html("endDate is missing"):$("#errorEdit_endDateEdit").html("")}function refreshpage(){Successmessage("Saved Successfully");setTimeout(location.reload.bind(location),2500)}function DefineToDateEnableExport(){$("#fromDate").val()!==""&&$("#toDate").val()!=""&&$("#taskExportBtn").attr("disabled",!1)}function spenthoursvalidation(){var n=$("#editedSpentHours").val();if(n=="")$("#error_hrsEgEdit").html("SpentHours is missing");else if(/^[0-9]{1,2}:[0-9]{1,2}$/.test(n))$("#errorEdit_hrsEgEdit").html("");else return $("#errorEdit_hrsEgEdit").html(""),$("#errorEdit_hrsEgEdit").html("Invalid time format"),!1}function userIDDuplicateValidation(){var n=$("#useridTxt").val();n!=""&&$.ajax({url:"../profile/GetUserIsDuplicate",data:{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val(),userID:n},type:"POST",async:!1,success:function(n){n&&$("#Accerror_useridTxt").html("UserID is already Exists")}})}function cancelSupportComment(n){$("#cmtText_"+n).show();$("#cmtSaveBtn_"+n).hide();$("#cmtCloseBtn_"+n).hide();$("#cmtCollapse_"+n).removeClass("in");$("#cmtCollapse_"+n).addClass("collapse");$("#taskComment").show();$("#btnCmtMandateSave").show();$("#btnCmtEdit_"+n).show()}function supportCommentDelete(n){var i=document.getElementById("comment_"+$("#btnCmtDelete_"+n).attr("data-mycommentitemid")),t;return n!=0&&n!=undefined&&(t=$('input[name="__RequestVerificationToken"]').val(),$.ajax({url:"../Profile/DeleteComment",data:{__RequestVerificationToken:t,SupportTaskCommentsNum:n},type:"post",async:!0,cache:!1,success:function(){Successmessage("Deleted Successfully");i.style.display="none";closeAfterCommentsSlide()}})),!1}function cmtEditClick(n){var i=$("#btnCmtEdit_"+n).attr("data-myitemid"),t;$("#commentEditBox_"+n).text(i);$("#taskComment").css("display","none");$("#btnCmtMandateSave").css("display","none");$("#cmtSaveBtn_"+n).show();$("#cmtCloseBtn_"+n).show();t=$("#commentEditBox_"+n).is(":visible");t?($("#btnCmtEdit_"+n).show(),$("#cmtText_"+n).show(),$("#taskComment").show(),$("#btnCmtMandateSave").show()):($("#cmtText_"+n).css("display","none"),$("#btnCmtEdit_"+n).hide());lastEditedCommentNum!=n&&(lastEditedCommentNum!=0&&(t=$("#commentEditBox_"+lastEditedCommentNum).is(":visible"),t&&($("#cmtText_"+lastEditedCommentNum).show(),$("#cmtCollapse_"+lastEditedCommentNum).removeClass("in"))),lastEditedCommentNum=n)}function refreshGridData(){$("#TaskData").data("kendoGrid").dataSource.read();$("#divAddtask").modal("hide")}function editedSuccess(){$("#TaskData").data("kendoGrid").dataSource.read();$("#modelClose").trigger("click")}function CommentClick(n){var t=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:"../Profile/_SupportTaskComment",type:"post",data:{__RequestVerificationToken:t,supportTaskNum:n.SupportTaskNum},success:function(n){isPopupEdited=!1;$("#divSupportTaskComments").html(n);$("#divSupportTaskComments").modal("show")}})}function uploadImage(){uploader.start()}function TextCopied(n){$("#link").attr("readonly",!1);var t=document.createElement("div");t.setAttribute("contentEditable",!0);t.innerHTML=document.getElementById(n).value;t.setAttribute("onfocus","document.execCommand('selectAll',false,null)");document.body.appendChild(t);t.focus();document.execCommand("copy");document.body.removeChild(t);$("#link").attr("readonly",!0)}function additionalParamInfo(){return{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}var uploader,lastEditedCommentNum=0;$(document).ready(function(){uploader=new plupload.Uploader({runtimes:"flash,html5",drop_element:"dropContent",browse_button:"browseBtn",url:"../UpdateUploadedImage",chunk_size:"1mb",filters:{mime_types:[{title:"Image files",extensions:"jpg,png"},],max_file_size:"1mb",prevent_duplicates:!0},views:{list:!0,thumbs:!0,active:"thumbs"},dragdrop:!0,init:{FilesAdded:function(n,t){$("#dropContent").removeAttr("border","1px dashed red");$("#dropContent").css("border","1px dashed #00abf0");var r=n.files.length;for(i=0;i<r-1;i++)n.removeFile(n.files[i]);plupload.each(t,function(n){$("#divFileArea").children().remove();var t=new o.Image;t.onload=function(){var n=document.createElement("div");n.id=this.uid;document.getElementById("divFileArea").appendChild(n);this.embed(n.id,{width:250,height:63})};t.load(n.getSource())})},BeforeUpload:function(){uploader.settings.multipart_params={__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}},FileUploaded:function(n,t){t.length!=0&&(Successmessage("Saved Successfully"),setTimeout(location.reload.bind(location),2500))},UploadComplete:function(){},Error:function(){}}});uploader.init()});$(document).on("click","#btnAddTask",function(){$.ajax({url:"../Profile/_AddTask",type:"Get",async:!1,contentType:"application/json",processData:!1,success:function(n){$("#divAddtask").html(n);$("#divAddtask").modal("show")}})});$(document).on("change","#spentHoursTxt",function(){var u=$("#totalHrsSpent")[0].innerHTML,n=u.split(":"),t=$("#spentHoursTxt").val(),f=t,r,i;if(strx=f.split(":"),array=[],array=array.concat(strx),r=$("#availableHours")[0].innerHTML,i=r.split(":"),t=="")$("#error_hrsEg").html("SpentHours is missing");else if(/^[0-9]{1,2}:[0-9]{1,2}$/.test(t)){if(Number(i[0])==0&&i[1]==undefined)return!1;if(Number(n[0])+Number(array[0])>hoursSpent||Number(n[0])+Number(array[0])==hoursSpent&&Number(n[1])+Number(array[1])>0)return $("#error_hrsEg").html(""),$("#error_hrsEg").html("Spent hours is exceed"),!1;$("#error_hrsEg").html("")}else return $("#error_hrsEg").html(""),$("#error_hrsEg").html("Invalid time format"),!1});$(document).on("click","#btnWorkFlowExport",function(){var t=defaultProcessNum,n=$("<form action='../Workflow/GetExportGridData' method='post'><\/form>");n.append("<input type='text' name='moduleNum' value='"+t+"' />");n.appendTo("body");n.submit();n.remove()});$(document).on("click","#taskExportBtn",function(){var t=$("#fromDate").val(),i=$("#toDate").val(),n=$("<form action='../Profile/TaskExport' method='post'><\/form>");n.append("<input type='text' name='fromDate' value='"+t+"' />");n.append("<input type='text' name='toDate' value='"+i+"' />");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()});$(document).on("click","#editTask",function(){var n=$("#TaskData").data("kendoGrid"),t=$(this).closest("tr").index(),i=n._data[t];$.ajax({url:"../Profile/_EditTask",type:"post",data:{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val(),taskNum:i.SupportTaskNum},success:function(n){$("#divEdittask").html(n);$("#divEdittask").modal("show")}})});$(document).on("click","[id$=commentShow]",function(){var n=$("#TaskData").data("kendoGrid"),t=$(this).closest("tr").index(),i=$(this).closest("tr"),r=n._data[t];CommentClick(r,i)});$(document).on("click","#checkValidation",function(){teamchanged();startDateChanged();endDateChanged();$("#spentHoursTxt").trigger("change");$("#teamTitleTxt").trigger("change");$("#teamDescriptionTxt").trigger("change");var n="";$('[id^="error_"]').each(function(){n=n+(this.textContent!=""&&this.textContent!=undefined&&this.textContent!=" "?this.textContent.trim()+"<br/>":"")});n=n.trim()=="<br/>"?"":n.trim();n==""&&$("#addForm").submit()});$(document).on("keyup","#teamTitleTxt",function(){var n=$("#teamTitleTxt").val();$("#countTxt").val(n.length)});$(document).on("keyup","#teamTitleEditTxt",function(){var n=$("#teamTitleEditTxt").val();$("#countTxtInEdit").val(n.length)});$(document).on("click","#addSupportHours,#minusSupportHours",function(){var n=$("#supportHrsTxt").val(),t=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:"../Profile/updateSpentHours",type:"Post",data:{__RequestVerificationToken:t,spentHours:n},success:function(){var u=$("#TaskData").data("kendoGrid");if(u._data.length>0){var s=u._data[0].TotalSpent,f=s.split(":"),e=f[0],t=f[1],i=n-e,o=Math.abs(60-t);t>0&&(i=i-1);t==0&&(o=0);var h=$("#hoursSpentPct")[0].innerHTML.replace("%",""),r=(getNumber(e+"."+t)/n*100).toFixed(0),c=Number(r)>100?100:r;$("#chart").removeClass("p"+h);$("#chart").addClass("p"+c);$("#availableHours").html(i+":"+o);$("#hoursSpentPct").html(r+"%");$("#btnAddTask").attr("disabled",!1)}}})});$(document).on("click","#updateTask",function(){teamchangedInEdit();startDateEditValidation();endDateEditValidation();spenthoursvalidation();$("#teamTitleEditTxt").trigger("change");$("#teamDescriptionEditTxt").trigger("change");var n="";$('[id^="errorEdit_"]').each(function(){n=n+(this.textContent!=""&&this.textContent!=undefined&&this.textContent!=" "?this.textContent.trim()+"<br/>":"")});n=n.trim()=="<br/>"?"":n.trim();n==""&&$("#editForm").submit()});$(document).on("change","#editedSpentHours",function(n){var t=$("#editedSpentHours").val(),f=n.target.defaultValue,r=f.split(":"),e=t;strx=e.split(":");array=[];array=array.concat(strx);var u=Number(array[0])-Number(r[0]),o=Number(array[1])-Number(r[1]),s=$("#availableHours")[0].innerHTML,i=s.split(":");if(t=="")$("#errorEdit_hrsEgEdit").html("Spent Hours is missing");else if(/^[0-9]{1,2}:[0-9]{1,2}$/.test(t)){if(Number(i[0])<u||Number(i[0])==u&&Number(i[1])<o)return $("#errorEdit_hrsEgEdit").html(""),$("#errorEdit_hrsEgEdit").html("Spent hours is exceed"),!1;$("#errorEdit_hrsEgEdit").html("")}else return $("#errorEdit_hrsEgEdit").html(""),$("#errorEdit_hrsEgEdit").html("Invalid time format"),!1});$(document).on("change","#teamTitleTxt",function(){$("#teamTitleTxt").val()==""?$("#error_teamTitleTxt").html("TeamTitle  is missing"):$("#error_teamTitleTxt").html("")});$(document).on("change","#teamTitleEditTxt",function(){$("#teamTitleEditTxt").val()==""?$("#errorEdit_teamTitleEditTxt").html("TeamTitle  is missing"):$("#errorEdit_teamTitleEditTxt").html("")});$(document).on("change","#firstname",function(){var n=$("#firstname").val();n==""?$("#Accerror_firstname").html("Firstname is missing"):$("#Accerror_firstname").html("")});$(document).on("change","#useridTxt",function(){var n=$("#useridTxt").val();n==""?$("#Accerror_useridTxt").html("UserID is missing"):$("#Accerror_useridTxt").html("")});$(document).on("click","#accountUpdateBtn",function(){userIDDuplicateValidation();var n="";$('[id^="Accerror_"]').each(function(){n=n+(this.textContent!=""&&this.textContent!=undefined&&this.textContent!=" "?this.textContent.trim()+"<br/>":"")});n=n.trim()=="<br/>"?"":n.trim();n==""&&$("#accountForm").submit()});$(document).on("change","#teamDescriptionTxt",function(){$("#teamDescriptionTxt").val()==""?$("#error_teamDescriptionTxt").html("Teamdescription is missing"):$("#error_teamDescriptionTxt").html("")});$(document).on("change","#teamDescriptionEditTxt",function(){$("#teamDescriptionEditTxt").val()==""?$("#errorEdit_teamDescriptionEditTxt").html("Teamdescription is missing"):$("#errorEdit_teamDescriptionEditTxt").html("")});$(document).on("show.bs.modal","#divSupportTaskComments",function(){var t=new Date,n=t.getTimezoneOffset()*6e4;$(".posted-date").each(function(){var i=$(this).html(),t=new Date(i);t=new Date(t.valueOf()-n);$(this).html(t.toLocaleTimeString())});$(".tooltiptext").each(function(){var i=$(this).html(),t=new Date(i);t=new Date(t.valueOf()-n);$(this).html(t.toLocaleDateString()+" "+t.toLocaleTimeString())})});