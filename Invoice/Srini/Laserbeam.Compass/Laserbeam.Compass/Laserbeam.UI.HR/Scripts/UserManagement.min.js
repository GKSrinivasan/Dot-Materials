function gridChange(){var n=this.dataItem(this.select());$.ajax({url:"../UserManagement/_UserModifyPopUp",data:{userNum:n.UserNum},type:"get",cache:!1,success:function(n){isModify=!0;$("#divAddUser").html(n);$("#divAddUser").modal("show")}})}function editStatusClick(){var n;editStatus=$("#btnEditUserStatus")[0].checked;editStatus==!1?(n="Active",$("#userStatus").val("Active")):editStatus==!0&&(n="Lock",$("#userStatus").val("Lock"));$("#editUserStatus").val(n)}function grdUserDataBound(){var n=$("#grdUserData").data("kendoGrid");n._data.length==0?($("#userData").hide(),$("#grdHeaderTxt").hide()):($("#userData").show(),$("#grdHeaderTxt").show())}function handleClick(){var n;addStatus=$("#btnAddUserStatus")[0].checked;addStatus==!1?(n="Active",$("#userStatus").val("Active"),$("#checkbox2").attr("disabled",!1)):addStatus==!0&&(n="Lock",$("#userStatus").val("Lock"),$("#checkbox2").attr("disabled",!0),$("#checkbox2").prop("checked",!1));$("#addUserStatus").val(n)}function userGridDataBound(){var t=$("#grdManageUser").data("kendoGrid"),n;t.dataSource._data.length==0&&(n=$("#grdManageUser").find("th").length,$("#grdManageUser").find("tbody").append('<tr class="kendo-data-row"><td colspan="'+n+'" style="text-align:center;background-color:#6686C4;padding-top:30px"><\/td><\/tr>'),$("#grdManageUser").find(".k-grid-content tbody tr td").css("padding-top",11).append('<b style="background-color:#6686C4 !important;color:white !important;">No Results Found!<\/b>'))}function sendReminderBound(){var t=$("#grdSendReminderNotification").data("kendoGrid"),n;t.dataSource._data.length==0&&(n=$("#grdSendReminderNotification").find("th").length,$("#grdSendReminderNotification").find("tbody").append('<tr class="kendo-data-row"><td colspan="'+n+'" style="text-align:center;background-color:#6686C4;padding-top:30px"><\/td><\/tr>'),$("#grdSendReminderNotification").find(".k-grid-content tbody tr td").css("padding-top",11).append('<b style="background-color:#6686C4 !important;color:white !important;">No Results Found!<\/b>'))}function closeAfterUserAdded(n){$("#divAddUser").modal("hide");$("#grdManageUser").data("kendoGrid").dataSource.read();n==2?Successmessage("Great ! User Added  Successfully"):Successmessage("User information modified successfully")}function UserGridData(){var n=$('input[name="__RequestVerificationToken"]').val();return{__RequestVerificationToken:n}}function additionalParamInfo(){return{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}function showUserStatusImage(n){var t;switch(n){case"Active":t="<label class='label label-success'>Active<\/label>";break;case"Yet To Login":t="<label class='label label-default'>Yet to Login<\/label>";break;case"Locked":t="<label class='label label-danger'>Locked<\/label>";break;default:t="<label class='label label-danger'>Locked<\/label>"}return t}function showMailStatusImage(n,t){var i="Last mail sent on :"+t;return n==!0?"<span class='glyphicon glyphicon-envelope tooltiptext' style='color:gray;' title='"+i+"'><\/span>":""}function userModifyPopUp(n){var n=n;$.ajax({url:"../UserManagement/_UserModifyPopUp",data:{userNum:n},type:"get",cache:!1,success:function(n){isModify=!0;$("#divAddUser").html(n);$("#divAddUser").modal("show")}})}function change(n){var t=this.dataItem(n.item.index()),i=t.UserRole;i=="Admin"?$("#accessCheckBox").css("visibility","hidden"):$("#accessCheckBox").css("visibility","hidden")}function DisplayNoResultsFound(n){var t=n.data("kendoGrid").dataSource,f=n.find(".k-grid-header colgroup > col").length,i,u,r;if(t._view.length==0&&n.find(".k-grid-content tbody").append('<tr class="kendo-data-row"><td colspan="'+f+'" style="text-align:center"><b>No Results Found!<\/b><\/td><\/tr>'),i=n.find(".k-grid-content tbody tr").length,i<t._take)for(u=t._take-i,r=0;r<u;r++)n.find(".k-grid-content tbody").append('<tr class="kendo-data-row"><td>&nbsp;<\/td><\/tr>')}function downloadUserTemplateData(){var n=$("<form action='../UserManagement/GetUserDataTemplate' method='post'><\/form>");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()}function getFileIconUsingMIME(n){return n.match("image")=="image"?"fa-file-image-o":n.match("word")=="word"?"fa-file-word-o":n.match("excel")=="excel"?"fa-file-excel-o":n.match("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?"fa-file-excel-o":n.match("powerpoint")=="powerpoint"?"fa-file-powerpoint-o":n.match("pdf")=="pdf"?"fa-file-pdf-o":n.match("text")=="text"?"fa-file-text-o":"fa-file-o"}function getFileSizeUsingBytes(n){var t;return n>=1048576?Math.round(n/1048576)+" MB)":n<=1048576&&n>=1024?Math.round(n/1024)+"KB":n<=1024?Math.round(n)+"Bytes":Math.round(n/1073741824)+"GB"}function getUserDataErrorList(){$.ajax({url:"../UserManagement/_GetUserDataErrorList",type:"GET",async:!1,contentType:"application/json",processData:!1,success:function(n){$("#userData-Error").html(n);$("#userData-Error").modal("show");$("#userDataerrorFiles").html($("#errorFiles").html())}})}function getErrorListExport(){var n=$("<form action='../UserManagement/GetUserDataErrorExport' method='post'><\/form>");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()}function EditorChanged(){emailChangeFlag=!0}function cancelSendEmailReminder(){var n=$("#grdSendReminderNotification").data("kendoGrid");n.dataSource.filter({});n.dataSource.sort({});n.refresh();$("#chkBoxSelectAll").removeAttr("checked");emailChangeFlag=!1;$("#divSendEmail").modal("hide")}function getErrorDataCount(){var n=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:"../UserManagement/GetUserDataErrorCount",type:"Post",data:{__RequestVerificationToken:n},success:function(n){n>0||isErrorTemplate?(getUserDataErrorList(),n>0&&$("#accessControlErrorLink").show(),isErrorTemplate=!1):$("#accessControlErrorLink").hide()}})}function getUserTileData(){var n=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:"../UserManagement/GetUserTileData",type:"post",data:{__RequestVerificationToken:n},success:function(n){$("#totalUsers").text(n[0].TotalCount);$("#activeUsers").text(n[0].ActiveCount);$("#yetToUsers").text(n[0].YetToStartCount);$("#lockedUsers").text(n[0].LockedUsersCount)}})}function grdUserErrorRecordDataBound(){var n=$("#grdUserDataError").data("kendoGrid");n._data.length==0?$("#divUserDataError").hide():$("#divUserDataError").show()}function setValidation(){$(".input-validation-error").parent().removeClass("has-success").addClass("has-error");$("div.validation-summary-errors").has("li:visible").addClass("alert-block alert-danger");$("#form").data("validator").settings.onfocusout=function(n){$(n).valid()}}var totalUsersCount=0,activeUsersCount=0,yetToLoginCount=0,lockedUsersCount=0,isFilter=!1,isModify=!1,uploader,emailChangeFlag=!1,isErrorTemplate=!1;$(document).ready(function(){$("#userDataProcess").attr("disabled",!0);$("#btnClearFilter").hide();getUserTileData();uploader=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",drop_element:"drop-area",browse_button:"browseBtn",url:"../Upload",filters:{mime_types:[{title:"Image files",extensions:"xlx,xlsx"},],max_file_size:"10mb",prevent_duplicates:!0},dragdrop:!0,init:{FilesAdded:function(n,t){plupload.each(t,function(n){var t=$("<div class='file-area' id='"+n.id+"' data-fileid='"+n.rid+"'><div class='file-icon'><span class='fa "+getFileIconUsingMIME(n.type)+"'><\/span><\/div><div class='file-content'><div style='font-size:14px;'>"+n.name+"<\/div><div style='font-size:10px;'>"+getFileSizeUsingBytes(n.size)+"<\/div><div class='progress'><div class='progress-bar'  id = 'upload' role='progressbar' aria-valuenow='0' aria-valuemin='0' aria-valuemax='100' style='width:0%;'>0%<\/div><\/div><\/div><div class='file-remove'><span class='fa fa-times' data-fileid='"+n.id+"'><\/span><\/div> <\/div>");$("#divFileArea").append(t);uploader.files.length>0&&$("#userDataProcess").removeAttr("disabled")})},UploadProgress:function(n,t){var i=$("#"+t.id).find(".progress-bar"),r=t.percent<75?t.percent:75;i.css("width",r+"%");i.text(r+"%");i.attr("aria-valuenow",r)},BeforeUpload:function(n,t){if(uploader.total.uploaded==0){$("#errorFiles").children().remove();var i=$("#ajaxLoadingPanel");i.height($(window).height());i.width($(window).width());i.css("top",$(window).scrollTop());i.css("left",$(window).scrollLeft());i.show()}uploader.settings.multipart_params=uploader.total.uploaded+1==uploader.files.length?{isLastFile:"yes",__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}:{isLastFile:"",__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()};$("#"+t.id).find(".progress").show();$(".file-remove").find("#"+t.id).hide()},FileUploaded:function(n,t,i){var r,u,f;i=JSON.parse(i.response);i.Message!=""&&(r=$("#"+t.id).find(".progress-bar"),u=100,i.Message!="Uploaded successfully"&&i.Message!="Processed successfully"&&(Errormessage(i.Message),isErrorTemplate=!0,r.css("background-color","red"),i.Message=="Invalid format or Password protected"?(f="<div style='word-wrap: break-word;margin-left:2% !important;margin-right:2% !important;'><div class='row'>"+t.name+"<br/> Invalid format or Password protected<\/div><\/div><br/>",$("#errorFiles").append(f)):(f="<div style='word-wrap: break-word;margin-left:2% !important;margin-right:2% !important;'><div class='row'>"+t.name+"<br/>"+i.Message+" Columns mismatch with template<\/div><\/div><br/>",$("#errorFiles").append(f))),r.css("width",u+"%"),r.text(u+"%"),r.attr("aria-valuenow",u),Successmessage(i.Message))},UploadComplete:function(n){n.splice();$("#divFileArea").children().remove();getUserTileData();$("#grdUserData").data("kendoGrid").dataSource.read();getErrorDataCount();$("#ajaxLoadingPanel").hide()},Error:function(n,t){var i=$("#"+t.file.id).find(".progress-bar"),r=100;i.css("width",r+"%");i.text(r+"%");i.attr("aria-valuenow",r)}}});uploader.init();$(document).on("hide.bs.modal","#userData-Error",function(){$("#errorFiles").children().remove()})});$(document).on("click","#lnkXmlUserDataFileName",function(){var t=$("#grdUserData").data("kendoGrid"),i=$(this).closest("tr"),r=$(i).index(),u=t._data[r],f=u.XMLProcessNum,n=$("<form action='../UserManagement/GetExportXmlFile' method='post'><\/form>");n.append("<input type='text' name='xmlProcessNum' value='"+f+"' />");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()});$(document).on("click","[id$=btnDelete]",function(n){var t=$("#grdUserData").data("kendoGrid"),i=$(this).closest("tr"),r=$(i).index(),u=t._data[r],f=u.XMLProcessNum,e=showConfirm(n,"Do you want to delete?"),o=$('input[name="__RequestVerificationToken"]').val();if(e)$.ajax({url:"../UserManagement/DeleteUserTemplateData",data:{__RequestVerificationToken:o,xmlProcessNum:f},type:"post",success:function(n){Successmessage(n);t.dataSource.read()}});else return!1});$(document).on("hide.bs.modal","#divAddUser",function(){isModify==!0&&$("#grdManageUser").data("kendoGrid").dataSource.read();isModify=!1});$(document).on("click","#btnAdduser",function(){var n=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:"../UserManagement/_UserAddPopUp",type:"get",success:function(n){$("#divAddUser").html(n);$("#divAddUser").modal("show")}})});$(document).on("click","#btnSendEmail",function(){$.ajax({url:"../UserManagement/_SendEmail",type:"get",async:!0,success:function(n){$("#sendReminderClearFilter").hide();$("#divSendEmail").html(n);$("#divSendEmail").modal("show")}})});$(document).on("click",".file-remove .fa-times",function(){var n=$(this).data("fileid");uploader.removeFile(n);$(this).parents(".file-area").remove();uploader.files.length==0?$("#userDataProcess").attr("disabled",!0):$("#userDataProcess").removeAttr("disabled")});$(document).on("click","#userDataProcess",function(){return uploader.start(),!1});$(document).on("change","#ddlUserRole",function(){var n=$("#ddlUserRole").data("kendoDropDownList").dataItem().UserRole;n=="--User Role--"?$("#txtUserRoleType").val(""):$("#txtUserRoleType").val(n);n=="Admin"?$("#accessCheckBox").css("visibility","visible"):$("#accessCheckBox").css("visibility","hidden")});$(document).on("click","#helpIcon",function(){$('[data-toggle="popover"]').popover()});$(document).on("click","#checkbox2",function(){this.checked?$("#isEmail").val("true"):$("#isEmail").val("false")});$(document).on("click","#btnCancel",function(){$("#addUser").modal("hide")});$(document).on("click","#filter",function(){$("body").css("overflow","hidden");$.ajax({url:"../UserManagement/_FilterSortPopup",type:"GET",cache:!1,async:!0,dataType:"html",success:function(n){$("#wndFilterSortPopup").html(n);var t=$("#wndFilterSortPopup").data("kendoWindow");t.options.gridName="grdManageUser";t.center().open();$("#filterseperator").css("display","inline");$("#hide").show();$("#clearfilter").css("display","inline");$("#btnClearFilter").show()}})});$(document).on("click","#sendReminderFilter",function(){$("body").css("overflow","hidden");$.ajax({url:"../UserManagement/_SendEmail_FilterSortPopup",type:"GET",cache:!1,async:!0,dataType:"html",success:function(n){$("#EmailFilterSortPopup").html(n);var t=$("#EmailFilterSortPopup").data("kendoWindow");t.options.gridName="grdSendReminderNotification";t.center().open();$("#filterseperator").css("display","inline");$("#sendReminderClearFilter").show()}})});$(document).on("click","#btnClearFilter",function(){clearFilterSort(!0);$("#btnClearFilter").hide();$("#filter").show()});$(document).on("click","#userExport",function(){var n=$("<form action='../UserManagement/AppUserExport' method='post'><\/form>");n.append("<input type='text' name='__RequestVerificationToken' value='"+$('input[name="__RequestVerificationToken"]').val()+"' />");n.appendTo("body");n.submit();n.remove()});$(document).on("click","#uploadUserTab",function(){$("#btnAdduser").hide();$("#dropdownMenu1").hide()});$(document).on("click","#userListTab",function(){$("#btnAdduser").show();$("#dropdownMenu1").show();$("#grdManageUser").data("kendoGrid").dataSource.read()});$(document).on("click","#btnDeleteUser",function(n){var t=$("#txtUserNum").val(),i=$("#txtUserId").val();return showConfirm(n,"Do you want to delete the user?")?(t!=null&&$.ajax({url:"../UserManagement/DeleteUser",data:{__RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val(),userNum:t,userId:i},type:"post",cache:!1,success:function(){$("#grdManageUser").data("kendoGrid").dataSource.read();getUserTileData();$("#divAddUser").modal("hide");Successmessage("Deleted the User Successfully")}}),!1):!1});$(document).on("click","#btnCancel",function(){$("#divAddUser").modal("hide")});$(document).on("focusout","#editUser",function(){$("#editUser").modal("hide")});$(document).on("click","#sendEmailReminder",function(){var s=$("#emailReminderEditor").val(),h=$("#emailReminderSubject").val(),c=$("#EmailBody").val(),t=$("#grdSendReminderNotification").data("kendoGrid"),n=[],i=[],r,u;if($("#chkBox input[type=checkbox]:checked").each(function(){var u=$(this).closest("tr"),r=$(u).index(),f=t._data[r];row=$(this).closest("tr");n.push(f);i.push(r)}),r=$("#emailReminderEditor").val(),u=$("#emailReminderSubject").val(),n.length==0)alert("Select atleast one user");else{var f=$('input[name="__RequestVerificationToken"]').val(),e=JSON.stringify(n),o=JSON.parse(e);$.ajax({url:"../UserManagement/SendEmailReminderToUser",type:"post",data:{__RequestVerificationToken:f,sendReminderMail:o,emailBody:$("#emailReminderEditor").val(),emailSubject:$("#emailReminderSubject").val()},dataType:"html",success:function(n){emailChangeFlag=!1;n==1&&($("#divSendEmail").html(n),$("#divSendEmail").modal("hide"),Successmessage("Sent Mail Successfully"));$("#chkBoxSelectAll").removeAttr("checked")}})}});$(document).on("click","[id$=chkBox]",function(){var n=$("input#chkBox:checked").length==$("input#chkBox").length?!0:!1;$("#chkBoxSelectAll")[0].checked=n;emailChangeFlag=!0});$(document).on("click","#checkbox1",function(){this.checked?$("#addUserAlert").show():($("#addUserAlert").hide(),$("#addAdminAccess").val(!1))});$(document).on("click","#adminAccessNotValid",function(){$("#checkbox1").prop("checked",!1);$("#addAdminAccess").val(!1);$("#addUserAlert").hide()});$(document).on("click","#adminAccessValid",function(){$("#checkbox1").prop("checked",!0);$("#addAdminAccess").val(!0);$("#addUserAlert").hide()});$(document).on("keydown","#txtUserId",function(n){var t=n.keyCode||n.which;t=="9"&&(n.preventDefault(),setTimeout(function(){$("#txtEmployeeID").focus()},0))});$(document).on("change","#emailReminderSubject",function(){emailChangeFlag=!0});$(document).on("show.bs.modal","#divAddUser",function(){var n,t;$("#addUserAlert").hide();$.validator.unobtrusive.parse(document);setValidation();n=$("#userStatus").val();(n=="Active"||n=="")&&$("#btnAddUserStatus").prop("checked",!0);n=="Lock"&&$("#btnAddUserStatus").prop("checked",!1);t=$("#addAdminAccess").val();t=="True"&&$("#checkbox1").prop("checked",!0);t=="False"&&$("#checkbox1").prop("checked",!1);$('[data-toggle="tooltip"]').tooltip();addStatus=$("#btnAddUserStatus")[0].checked;addStatus==!1?($("#checkbox2").attr("disabled",!0),$("#checkbox2").prop("checked",!1)):addStatus==!0&&$("#checkbox2").attr("disabled",!1)});$(document).on("show.bs.modal","#divSendEmail",function(){$("#sendReminderClearFilter").hide()});$(document).on("click","#chkBoxSelectAll",function(){this.checked?$("#chkBox input[type=checkbox]").each(function(){this.checked=!0}):$("#chkBox input[type=checkbox]").each(function(){this.checked=!1})});$(function(){$('[data-toggle="tooltip"]').tooltip()});