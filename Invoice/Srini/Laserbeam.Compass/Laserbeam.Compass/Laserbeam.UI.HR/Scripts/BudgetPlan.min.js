function budgetPlanDataBound(){var n=$("#grdBudgetPlan").data("kendoGrid"),t=n.dataSource.view(),o,u,f;if(t.length>0){var i=t[0].BaseCurrencyCode,r=t[0].SelectedCurrencyCode,e=t[0].SelectedExchangeRate;t[0].ProrationVisible===!1&&(n.hideColumn("ProratedBudget"),n.hideColumn("ProratedBudgetPct"),n.showColumn("Budget"),n.showColumn("BudgetPct"),$("#proratedAmtDiv").hide(),$("#proratedPctDiv").hide(),$("#budgetAmtDiv").show(),$("#budgetPctDiv").show(),isProrationVisible="False",$("#prorateCheckBox").prop("checked",!1),$("#idProrateTooltip").css("display","none"),$("#proratedPopUp").hide());t[0].ProrationVisible===!0&&(n.hideColumn("Budget"),n.hideColumn("BudgetPct"),n.showColumn("ProratedBudget"),n.showColumn("ProratedBudgetPct"),$("#budgetAmtDiv").hide(),$("#budgetPctDiv").hide(),$("#proratedAmtDiv").show(),$("#proratedPctDiv").show(),isProrationVisible="True",$("#prorateCheckBox").prop("checked",!0),$("#idProrateTooltip").css("display","inline"),$("#proratedPopUp").show());o=n.tbody.children("tr");t=n.dataSource.view();isFilter==!1?(baseCurrency=t[0].BaseCurrency,totalSalary=n.dataSource._data[0].TotalSalary,prorateStartDateValue=t[0].ProrationStartDate,prorateEndDateValue=t[0].ProrationEndDate,startDateValue=t[0].StartDate,endDateValue=t[0].EndDate,budgetPercent=t[0].BudgetPercent,totalSalaryValue=n.dataSource._data[0].TotalSalary,budgetAmtValue=n.dataSource._data[0].TotalBudget,budgetPctValue=totalSalaryValue==0?0:budgetAmtValue/totalSalaryValue*100,adjustBudgetValue=n.dataSource._data[0].TotalAdjustedBudget,adjustBudgetPct=totalSalaryValue==0?0:adjustBudgetValue/totalSalaryValue*100,proratedBudgetValue=n.dataSource._data[0].TotalProratedBudget,proratedBudgetPct=totalSalaryValue==0?0:proratedBudgetValue/totalSalaryValue*100,totalSpentValue=n.dataSource._data[0].TotalSpent,balanceValue=adjustBudgetValue-totalSpentValue,totalCountValue=n.dataSource._data[0].TotalEmployeeCount,meritSpentValue=n.dataSource._data[0].TotalMeritSpent,lumpsumSpentValue=n.dataSource._data[0].TotalLumpSumSpent,promotionSpentValue=n.dataSource._data[0].TotalPromotionSpent,adjustmentSpentValue=n.dataSource._data[0].TotalAdjustmentSpent,budgetValuesRefresh(),isEnableMerit=="False"&&$("#lgtMerit").hide(),isEnableLumpSum=="False"&&$("#lgtLumpSum").hide(),isEnablePromotion=="False"&&$("#lgtPromotion").hide(),isEnableAdjustment=="False"&&$("#lgtAdjustment").hide(),$("#grdBudgetPlan").data("kendoGrid").dataSource._filter!=undefined&&$("#btnClearFilter").show(),i==r?$("#conversionRate").hide():($("#conversionRate").text("1 "+i+" = "+1*e+" "+r),$("#conversionRate").show())):isFilter==!0&&(totalSalaryValue=n.dataSource._data[0].TotalSalary,adjustBudgetValue=n.dataSource._data[0].TotalAdjustedBudget,adjustBudgetPct=totalSalaryValue==0?0:adjustBudgetValue/totalSalaryValue*100,averageBudgetPct=n.dataSource._data[0].AverageBudgetPct,$("#adjustedBudgetPct").text(formatGridValue(averageBudgetPct.toFixed(2),"BudgetPct","Percentage",preferredCulture)+"%"),$("#budgetPct").text(formatGridValue(adjustBudgetPct,"BudgetPct","Percentage",preferredCulture)+"%"))}else t.length==0&&(u=$("#grdBudgetPlan").data("kendoGrid"),u.dataSource._view.length==0&&(f=$("#grdBudgetPlan").find("th").length,$("#grdBudgetPlan").find("tbody").append('<tr class="kendo-data-row"><td colspan="'+f+'" style="text-align:center;background-color:#6686C4;color:white !important;">No Results Found!<\/td><\/tr>')))}function budgetValuesRefresh(){totalSalary=totalSalary;prorateStartDateValue!=""?$("#idStartDate").text(startDateValue):$("#idStartDate").text("");prorateEndDateValue!=""?$("#idEndDate").text(endDateValue):$("#idEndDate").text("");$("#totalSpentAmt").text(formatBudgetCurrency(totalSpentValue,"c0",preferredCulture));$("#balanceAmt").text(formatBudgetCurrency(balanceValue,"c0",preferredCulture));$("#totalCount").text(totalCountValue);$("#totalSalary").text(formatBudgetCurrency(totalSalaryValue,"c0",preferredCulture));$("#budgetAmt").text(formatBudgetCurrency(adjustBudgetValue,"c0",preferredCulture));$("#budgetPct").text(formatGridValue(adjustBudgetPct,"BudgetPct","Percentage",preferredCulture)+"%");$("#amt").val(formatGridValue(budgetAmtValue,"BudgetAmt","Dollar",preferredCulture));$("#Budgetpercent").val(getNumberValue(budgetPercent,preferredCulture).toFixed(2));$("#adjustedBudgetAmt").text(formatGridValue(adjustBudgetValue,"BudgetAmt","Dollar",preferredCulture));$("#adjustedBudgetPct").text(formatGridValue(adjustBudgetPct.toFixed(2),"BudgetPct","Percentage",preferredCulture)+"%");$("#proratedAmt").val(formatGridValue(proratedBudgetValue,"BudgetAmt","Dollar",preferredCulture));$("#proratedBudgetpercent").val(formatGridValue(budgetPercent,"BudgetPct","Percentage",preferredCulture));$("#meritSpent").text(formatBudgetCurrency(meritSpentValue,"c0",preferredCulture));$("#lumpsumSpent").text(formatBudgetCurrency(lumpsumSpentValue,"c0",preferredCulture));$("#promotionSpent").text(formatBudgetCurrency(promotionSpentValue,"c0",preferredCulture));$("#adjustmentSpent").text(formatBudgetCurrency(adjustmentSpentValue,"c0",preferredCulture));createGauge()}function onUpdateRequestEnd(n){n.type=="update"&&$("#grdBudgetPlan").data("kendoGrid").dataSource.read()}function gridUser_sync(){var n=$("#grdBudgetPlan").data("kendoGrid");n.dataSource.read()}function BudgetGridData(){var n,t=$('input[name="__RequestVerificationToken"]').val(),i=$("#ddlLocalCurrenciesBudget").data("kendoDropDownList"),r=i.dataItem($("#ddlLocalCurrenciesBudget").data("kendoDropDownList").select());return n=$("#selectedCurrencyNum").val(),n=n==0?r.CurrencyNum:n,{__RequestVerificationToken:t,selectedCurrencyNum:n}}function formatGridValue(n,t,i,r){var u,f;return n==null?"":i=="Percentage"?(u=getCultureFormat(t,i),f=formatValue(n,u,r),f.replace(" ","")):(u=getCultureFormat(t,i),f=formatValue(n,u,r),f)}function getCultureFormat(n,t){if(t=="Percentage"&&n=="BudgetPct"){var u=BudgetPlanConfiguration.RoundingBudgetPercentage.toLowerCase(),i=BudgetPlanConfiguration.DecimalBudgetPercentage,r=getnoOfDecimalPlaces(i);return("n"+r).toString()}if(t=="Dollar"&&n=="BudgetAmt"){var u=BudgetPlanConfiguration.RoundingBudgetDoller.toLowerCase(),i=BudgetPlanConfiguration.DecimalBudgetDoller,r=getnoOfDecimalPlaces(i);return("c"+r).toString()}}function getnoOfDecimalPlaces(n){return decimalPlaces(n)}function roundingRule(n,t,i){if(i=="Percentage"&&t=="BudgetPct"){var u=BudgetPlanConfiguration.RoundingBudgetPercentage.toLowerCase(),f=BudgetPlanConfiguration.DecimalBudgetPercentage,r=roundingNumbers(u,n,f);return r==undefined||r==null||r==""||r==NaN||isNaN(r)?0:r}if(i=="Dollar"&&t=="BudgetAmt"){var u=BudgetPlanConfiguration.RoundingBudgetDoller.toLowerCase(),f=BudgetPlanConfiguration.DecimalBudgetDoller,r=roundingNumbers(u,n,f);return r==undefined||r==null||r==""||r==NaN||isNaN(r)?0:r}}function getdecimalPlaces(n){var t=decimalPlaces(n),i;return t<=0&&(i=n.toString().replace(/[^0]/g,"").length,t=-Math.abs(i)),t}function decimalPlaces(n){var t=(""+n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}function roundingNumbers(n,t,i){var r=getdecimalPlaces(i);if(r>0){if(n=="absolute")return Number(Math.round(t+"e"+r)+"e-"+r);if(n=="roundup")return Number(Math.ceil(t+"e"+r)+"e-"+r);if(n=="rounddown")return Number(Math.floor(t+"e"+r)+"e-"+r)}else{if(r=Math.abs(r),n=="absolute")return Number(Math.round(t+"e-"+r)+"e"+r);if(n=="roundup")return Number(Math.ceil(t+"e-"+r)+"e"+r);if(n=="rounddown")return Number(Math.floor(t+"e-"+r)+"e"+r)}}function getBalance(n){return n<0?"<span style='color:red'>"+formatGridValue(roundingRule(n,"BudgetAmt","Dollar"),"BudgetAmt","Dollar",preferredCulture)+"<\/span>":"<span>"+formatGridValue(roundingRule(n,"BudgetAmt","Dollar"),"BudgetAmt","Dollar",preferredCulture)+"<\/span>"}function allowDecimalNumberOnlyInput(n){$.inArray(n.keyCode,[46,8,9,27,13,110,190])!==-1||n.keyCode==65&&(n.ctrlKey===!0||n.metaKey===!0)||n.keyCode>=35&&n.keyCode<=40||(n.shiftKey||n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.preventDefault()}function onChange(){var n=$("#ddlLocalCurrenciesBudget").data("kendoDropDownList").dataItem($("#ddlLocalCurrenciesBudget").data("kendoDropDownList").select());$("#selectedCurrencyNum").val(n.CurrencyNum);preferredCulture=n.CultureCode;ddlcurrencyDropOldvalue!=n.CurrencyNum&&(ddlcurrencyDropOldvalue=n.CurrencyNum,ddlCurrencyCulture=n.CultureCode,ddlExchangeRate=n.ExchangeRate,ddlCurrencyCodeNum=n.CurrencyNum);$("#grdBudgetPlan").data("kendoGrid").dataSource.read()}function dataBound(){var t=$("#ddlLocalCurrenciesBudget").data("kendoDropDownList"),n;DefaultCurrencyNum!="0"?t.value(DefaultCurrencyNum):t.value(0);ddlcurrencyDropOldvalue=t.value();n=t.dataItem($("#ddlLocalCurrenciesBudget").data("kendoDropDownList").select());n!=undefined&&(ddlCurrencyCodeNum=n.CurrencyNum,ddlCurrencyCulture=n.CultureCode!=undefined?n.CultureCode:"en-US",ddlExchangeRate=n.ExchangeRate!=undefined?n.ExchangeRate:1)}function calculateBudgetAmt(n){var t=n/100*totalSalary;$("#amt").val(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture));$("#Budgetpercent").val(getNumberValue(n,preferredCulture)==null?formatGridValue(n,"BudgetPct","Percentage",preferredCulture):+getNumberValue(n,preferredCulture).toFixed(2))}function calculateBudgetPct(n){var t=(n/totalSalary*100).toFixed(2);t>999?showAlert("Value exceeds the maximum limit"):($("#amt").val(formatGridValue(n,"BudgetAmt","Dollar",preferredCulture)),$("#Budgetpercent").val(getNumberValue(n,preferredCulture)==null?formatGridValue(t,"BudgetPct","Percentage",preferredCulture):+getNumberValue(t,preferredCulture).toFixed(2)))}function calculateProratedBudgetAmt(n){var t=n/100*totalSalary;$("#proratedAmt").val(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture));$("#proratedBudgetpercent").val(formatGridValue(n.toFixed(2),"BudgetPct","Percentage",preferredCulture))}function calculateProratedBudgetPct(n){var t=(n/totalSalary*100).toFixed(2);t>999?showAlert("Value exceeds the maximum limit"):($("#proratedAmt").val(formatGridValue(n,"BudgetAmt","Dollar",preferredCulture)),$("#proratedBudgetpercent").val(formatGridValue(t,"BudgetPct","Percentage",preferredCulture)))}function createGauge(n){var t=(meritSpentValue/adjustBudgetValue*100).toFixed(2),i=(lumpsumSpentValue/adjustBudgetValue*100).toFixed(2),u=(promotionSpentValue/adjustBudgetValue*100).toFixed(2),r=parseFloat(t)+parseFloat(i),f=parseFloat(t)+parseFloat(i)+parseFloat(u);$("#gauge").kendoRadialGauge({pointer:{value:65,color:"transparent"},gaugearea:{margin:20},scale:{minorUnit:5,startAngle:-30,endAngle:210,max:100,labels:{position:n||"inside",visible:!1},ranges:[{from:0,to:t,color:"#71c055"},{from:t,to:r,color:"#fec679"},{from:r,to:f,color:"#71c4ee"}]}})}function formatBudgetCurrency(n,t,i){var e,u,o,r,f;return n==null?"":isNaN(n)?"":(e=$("#ddlLocalCurrenciesBudget").data("kendoDropDownList").dataItem($("#ddlLocalCurrenciesBudget").data("kendoDropDownList").select()),u=kendo.cultures[i],u=u!=undefined?u.numberFormat.currency.symbol:kendo.cultures["en-US"].numberFormat.currency.symbol,o=e!=undefined?e.CurrencyCode:"USD",n.length==1||t==undefined?n.toString():i==undefined?(r=kendo.toString(n,t),r=r.indexOf("-")>-1?"("+r.replace("-","")+")":r,RuleConfiguration.FeatureConfigurationCurrencyCodeDisplay&&(r=r.replace(u,o+" ")),r):(f=kendo.toString(n,t,i),f=f.indexOf("-")>-1?"("+f.replace("-","")+")":f,f.replace(u,o+" ")))}function closeAfterProration(){$("#grdBudgetPlan").data("kendoGrid").dataSource.read();$("#divProration").modal("hide");Successmessage("Saved Successfully")}function onSavePromotion(){$("#idProrateTooltip").css("display","inline")}function setValidation(){$(".input-validation-error").parent().removeClass("has-success").addClass("has-error");$("div.validation-summary-errors").has("li:visible").addClass("alert-block alert-danger")}function prorationStartDateChange(n){var i=n.sender._oldText,t;$("#processStartDateValue").val(i);t=$("#prorationEndDate").data("kendoDatePicker")._oldText;$("#processEndDateValue").val(t);isProrationChanged=!0}function prorationEndDateChange(n){var i=n.sender._oldText,t;$("#processEndDateValue").val(i);t=$("#prorationStartDate").data("kendoDatePicker")._oldText;$("#processStartDateValue").val(t);isProrationChanged=!0}var totalSalary,applyBudgetChange=!1,prorateStartDateValue="",prorateEndDateValue="",startDateValue="",endDateValue="",totalSpentValue=0,balanceValue=0,totalCountValue=0,totalSalaryValue=0,budgetAmtValue=0,budgetPctValue=0,adjustBudgetValue=0,adjustBudgetPct=0,meritSpentValue=0,lumpsumSpentValue=0,promotionSpentValue=0,adjustmentSpentValue=0,proratedBudgetValue=0,proratedBudgetPct=0,budgetPercent=0,baseCurrency,isProrationChanged=!1,isPageChanged=!1,isFilter=!1,startDateData,endDateData,isMerit;$(document).on("click","#btnClearFilter",function(){clearFilterSort(!0);$("#btnClearFilter").hide();$("#filter").show();isFilter=!1});$(document).ready(function(){$("#btnCreateGroup").hide();$("#btnClearFilter").hide();$(document).on("hide.bs.modal","#divProration",function(){isProrationVisible=="True"?($("#prorateCheckBox").prop("checked",!0),$("#idProrateTooltip").css("display","inline")):($("#prorateCheckBox").prop("checked",!1),$("#idProrateTooltip").css("display","none"),$("#proratedPopUp").hide())});isProrationVisible=="True"?($("#prorateCheckBox").prop("checked",!0),$("#idProrateTooltip").css("display","inline")):($("#prorateCheckBox").prop("checked",!1),$("#idProrateTooltip").css("display","none"),$("#proratedPopUp").hide());$(document).on("click","#proratedPopUp",function(){$.ajax({url:"../BudgetPlan/_Proration",type:"Get",success:function(n){$("#divProration").html(n);$("#divProration").modal("show")}})});$(document).on("keydown","#Budgetpercent",function(n){allowDecimalNumberOnlyInput(n)});$(document).on("keypress","#Budgetpercent",function(){var n=$("#Budgetpercent").val(),t;n.indexOf(".")>-1&&n.split(".")[1].length>1&&(t=n.split(".")[1].substring(0,1),$("#Budgetpercent").val(n.split(".")[0]+"."+t))});$(document).on("keydown","#amt",function(n){allowDecimalNumberOnlyInput(n)});$(document).on("keydown","#proratedBudgetpercent",function(n){allowDecimalNumberOnlyInput(n)});$(document).on("keypress","#proratedBudgetpercent",function(){var n=$("#proratedBudgetpercent").val(),t;n.indexOf(".")>-1&&n.split(".")[1].length>1&&(t=n.split(".")[1].substring(0,1),$("#proratedBudgetpercent").val(n.split(".")[0]+"."+t))});$(document).on("keypress","#proratedAmt",function(){var n=$("#proratedAmt").val(),t;n.indexOf(".")>-1&&n.split(".")[1].length>1&&(t=n.split(".")[1].substring(0,1),$("#proratedAmt").val(n.split(".")[0]+"."+t))});$(document).on("keydown","#proratedAmt",function(n){allowDecimalNumberOnlyInput(n)});$(document).on("click","#btnApplyBudgetPct",function(){var i="",t=$("#grdBudgetPlan").data("kendoGrid"),f,e,r,n,u;if(t.dataSource._filter!=undefined&&(t.dataSource._filter.length!=0||t.dataSource._sort.length!=0))for(f=t.dataSource._view,e=t.dataSource._view.length,r=0;r<e;r++)i=i+","+f[r].ManagerNum;isProrationVisible=="False"&&applyBudgetChange==!0&&$("#Budgetpercent").val()!=""&&(n=getNumberValue($("#Budgetpercent").val(),preferredCulture)==null?formatGridValue(getNumberValue($("#Budgetpercent").val(),preferredCulture),"BudgetPct","Percentage",preferredCulture):+getNumberValue($("#Budgetpercent").val(),preferredCulture).toFixed(2),$("#Budgetpercent").text(n+"%"),u=$('input[name="__RequestVerificationToken"]').val(),$.ajax({url:"../BudgetPlan/PutBudgetPct",type:"post",data:{__RequestVerificationToken:u,BudgetPercent:n,isProration:!1,filterEmployee:i},success:function(){$("#grdBudgetPlan").data("kendoGrid").dataSource.read();applyBudgetChange=!1;Successmessage("Great ! you have successfully distributed the budget for all managers");objChangeFlag=!1}}));isProrationVisible=="True"&&applyBudgetChange==!0&&$("#proratedBudgetpercent").val()!=""&&(n=formatGridValue(roundingRule(getNumberValue($("#proratedBudgetpercent").val(),preferredCulture),"BudgetPct","Percentage"),"BudgetPct","Percentage",preferredCulture),$("#proratedBudgetpercent").text(n+"%"),u=$('input[name="__RequestVerificationToken"]').val(),$.ajax({url:"../BudgetPlan/PutBudgetPct",type:"post",data:{__RequestVerificationToken:u,BudgetPercent:n,isProration:!0,filterEmployee:i},success:function(){$("#grdBudgetPlan").data("kendoGrid").dataSource.read();applyBudgetChange=!1;objChangeFlag=!1;Successmessage("Great ! you have successfully distributed the budget for all managers")}}))});$(document).on("change","#Budgetpercent",function(n){var t,r,i,u;applyBudgetChange=!0;t=getNumberValue($(n.target).val());t>999?(showAlert("Value exceeds the maximum limit"),$(this).val("")):calculateBudgetAmt(t);r=$(n.target).val().length;i=$(n.target).val().indexOf(".");i>0&&(u=r-(i+1),u>4&&$(this).val(t.toFixed(4)));$("[id=txtAdjustedBudget]").attr("disabled","disabled");$("[id=txtAdjustedBudgetPCT]").attr("disabled","disabled");$("#btnApplyBudgetPct").show();$("#btnCreateGroup").hide();Warningmessage(" Click on Distribute budget button to release the allocated budget to managers. ");objChangeFlag=!0});$(document).on("change","#amt",function(n){applyBudgetChange=!0;var t=getNumberValue($(n.target).val());calculateBudgetPct(t);$("[id=txtAdjustedBudget]").attr("disabled","disabled");$("[id=txtAdjustedBudgetPCT]").attr("disabled","disabled");$("#btnApplyBudgetPct").show();$("#btnCreateGroup").hide();Warningmessage(" Click on Distribute budget button to release the allocated budget to managers. ")});$(document).on("change","#proratedBudgetpercent",function(n){var t,r,i,u;applyBudgetChange=!0;t=getNumberValue($(n.target).val());t>999?(showAlert("Value exceeds the maximum limit"),$(this).val("")):calculateProratedBudgetAmt(t);r=$(n.target).val().length;i=$(n.target).val().indexOf(".");i>0&&(u=r-(i+1),u>4&&$(this).val(t.toFixed(4)));$("[id=txtAdjustedBudget]").attr("disabled","disabled");$("[id=txtAdjustedBudgetPCT]").attr("disabled","disabled");$("#btnApplyBudgetPct").show();$("#btnCreateGroup").hide();Warningmessage(" Click on Distribute budget button to release the allocated budget to managers. ");objChangeFlag=!0});$(document).on("change","proratedAmt",function(n){applyBudgetChange=!0;var t=getNumberValue($(n.target).val());calculateProratedBudgetPct(t);$("[id=txtAdjustedBudget]").attr("disabled","disabled");$("[id=txtAdjustedBudgetPCT]").attr("disabled","disabled");$("#btnApplyBudgetPct").show();$("#btnCreateGroup").hide();Warningmessage(" Click on Distribute budget button to release the allocated budget to managers. ");objChangeFlag=!0});$(document).on("keydown","[id$=txtAdjustedBudgetPCT]",function(n){allowDecimalNumberOnlyInput(n)});$(document).on("keypress","[id$=txtAdjustedBudgetPCT]t",function(){var n=$("[id$=txtAdjustedBudgetPCT]").val(),t;n.indexOf(".")>-1&&n.split(".")[1].length>1&&(t=n.split(".")[1].substring(0,1),$("[id$=txtAdjustedBudgetPCT]").val(n.split(".")[0]+"."+t))});$(document).on("keypress","[id$=txtAdjustedBudget]",function(){var n=$("[id$=txtAdjustedBudget]").val(),t;n.indexOf(".")>-1&&n.split(".")[1].length>1&&(t=n.split(".")[1].substring(0,1),$("[id$=txtAdjustedBudget]").val(n.split(".")[0]+"."+t))});$(document).on("keydown","[id$=txtAdjustedBudget]",function(n){allowDecimalNumberOnlyInput(n)});$(document).on("click","#btnCreateGroup",function(){var n=$("#grdBudgetPlan").data("kendoGrid");n.dataSource.sync();objChangeFlag=!1;$("[id=Budgetpercent]").attr("disabled",!1);$("[id=amt]").attr("disabled",!1);$("[id=proratedBudgetpercent]").attr("disabled",!1);$("[id=proratedAmt]").attr("disabled",!1);Successmessage("Great ! you have successfully distributed the budget for all managers")})});$(document).on("click","#filter",function(){$("body").css("overflow","hidden");var n=$("th[data-field='ProratedBudget']").css("display")=="none"?!1:!0,t=$("th[data-field='Budget']").css("display")=="none"?!1:!0;$.ajax({url:"../BudgetPlan/_FilterSort",type:"GET",cache:!1,async:!0,dataType:"html",data:{IsProratedBudgetEnable:n,IsBudgetEnable:t},success:function(n){$("#wndFilterSort").html(n);var t=$("#wndFilterSort").data("kendoWindow");t.options.gridName="grdBudgetPlan";t.center().open();$("#filterseperator").css("display","inline");isFilter=!0}})});$(document).on("click","#prorationDaily",function(){prorationType="Daily";$("#txtProrationDuration").val(365);$("#prorationSample").text("365 days");$("#prorationDaily").removeClass("btn-deactive");$("#prorationDaily").addClass("btn-active");$("#prorationWeekly").addClass("btn-deactive");$("#prorationMonthly").addClass("btn-deactive");$("#prorationType").val("Daily");$("#datePerMonth").html("");isProrationChanged=!0});$(document).on("click","#prorationWeekly",function(){prorationType="Weekly";$("#txtProrationDuration").val(52);$("#prorationSample").text("52 weeks");$("#prorationWeekly").removeClass("btn-deactive");$("#prorationWeekly").addClass("btn-active");$("#prorationDaily").addClass("btn-deactive");$("#prorationMonthly").addClass("btn-deactive");$("#prorationType").val("Weekly");$("#datePerMonth").html("");isProrationChanged=!0});$(document).on("click","#prorationMonthly",function(){prorationType="Monthly";$("#txtProrationDuration").val(12);$("#prorationSample").text("12 months");$("#prorationMonthly").removeClass("btn-deactive");$("#prorationMonthly").addClass("btn-active");$("#prorationDaily").addClass("btn-deactive");$("#prorationWeekly").addClass("btn-deactive");$("#prorationType").val("Monthly");$("#datePerMonth").html("");var n=$("#txtProrationDatesPerMonth").val();$("#txtProrationDatesPerMonth").val(n==""?16:n);isProrationChanged=!0});$(document).on("change","#meritChkBox",function(){var n,t;this.checked?(isMerit=!0,$("#isMerit").val("true")):(isMerit=!1,$("#isMerit").val("false"));n=$("#prorationStartDate").data("kendoDatePicker")._oldText;$("#processStartDateValue").val(n);t=$("#prorationEndDate").data("kendoDatePicker")._oldText;$("#processEndDateValue").val(t)});$(document).on("change","[id$=txtAdjustedBudget]",function(){var u,t,r;$("[id=Budgetpercent]").attr("disabled","disabled");$("[id=amt]").attr("disabled","disabled");$("[id=proratedBudgetpercent]").attr("disabled","disabled");$("[id=proratedAmt]").attr("disabled","disabled");$("#btnApplyBudgetPct").hide();$("#btnCreateGroup").show();setPageChanged(!0);var i=$("#grdBudgetPlan").data("kendoGrid"),e=$(this).closest("tr"),n=i.dataItem(e),o=$(e).index(),f=n.AdjustedBudget;n.AdjustedBudget=Math.round(getNumberValue(this.value,preferredCulture));n.AdjustedBudgetPct=n.AdjustedBudget/n.BaseCurrentSalary*100;n.AdjustedBudgetRoundedPct=(n.AdjustedBudget/n.BaseCurrentSalary*100).toFixed(2);u=n.AdjustedBudget;n.Balance=n.AdjustedBudget-n.Spent;n.dirty=!0;i.refresh();f<u&&(t=i.dataSource._data[0].TotalAdjustedBudget+(u-f),r=t/i.dataSource._data[0].TotalSalary*100,$("#adjustedBudgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#adjustedBudgetPct").text(formatGridValue(r.toFixed(2),"BudgetPct","Percentage",preferredCulture)+"%"),$("#budgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#budgetPct").text(formatGridValue(Math.round(r),"BudgetPct","Percentage",preferredCulture)+"%"));f>u&&(t=i.dataSource._data[0].TotalAdjustedBudget-(f-u),r=t/i.dataSource._data[0].TotalSalary*100,$("#adjustedBudgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#adjustedBudgetPct").text(formatGridValue(r.toFixed(2),"BudgetPct","Percentage",preferredCulture)+"%"),$("#budgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#budgetPct").text(formatGridValue(Math.round(r),"BudgetPct","Percentage",preferredCulture)+"%"));Warningmessage(" Click on Distribute budget button to release the updated budget. ");objChangeFlag=!0});$(document).on("change","[id$=txtAdjustedBudgetPCT]",function(){var u,t,r;$("[id=Budgetpercent]").attr("disabled","disabled");$("[id=amt]").attr("disabled","disabled");$("[id=proratedBudgetpercent]").attr("disabled","disabled");$("[id=proratedAmt]").attr("disabled","disabled");$("#btnApplyBudgetPct").hide();$("#btnCreateGroup").show();setPageChanged(!0);var i=$("#grdBudgetPlan").data("kendoGrid"),e=$(this).closest("tr"),n=i.dataItem(e),f=n.AdjustedBudget;n.AdjustedBudgetPct=+(getNumberValue(this.value)==null?Number(this.value):getNumberValue(this.value)).toFixed(2);n.AdjustedBudgetRoundedPct=n.AdjustedBudgetPct;n.AdjustedBudget=n.BaseCurrentSalary*n.AdjustedBudgetPct/100;u=n.AdjustedBudget;n.dirty=!0;n.Balance=n.AdjustedBudget-n.Spent;i.refresh();f<u&&(t=i.dataSource._data[0].TotalAdjustedBudget+(u-f),r=t/i.dataSource._data[0].TotalSalary*100,$("#adjustedBudgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#adjustedBudgetPct").text(formatGridValue(r.toFixed(2),"BudgetPct","Percentage",preferredCulture)+"%"),$("#budgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#budgetPct").text(formatGridValue(r,"BudgetPct","Percentage",preferredCulture)+"%"));f>u&&(t=i.dataSource._data[0].TotalAdjustedBudget-(f-u),r=t/i.dataSource._data[0].TotalSalary*100,$("#adjustedBudgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#adjustedBudgetPct").text(formatGridValue(r.toFixed(2),"BudgetPct","Percentage",preferredCulture)+"%"),$("#budgetAmt").text(formatGridValue(t,"BudgetAmt","Dollar",preferredCulture)),$("#budgetPct").text(formatGridValue(r,"BudgetPct","Percentage",preferredCulture)+"%"));Warningmessage(" Click on Distribute budget button to release the updated budget. ");objChangeFlag=!0});$("#btnFilter").click(function(){var n=$("#wndFilterSort").data("kendoWindow");n.options.gridName="grdBudgetPlan";n.center().open()});$(document).on("click","#prorateCheckBox",function(n){if(!showSaveWarning(n))return!1;if(this.checked)$.ajax({url:"../BudgetPlan/_ProrationPopUp",type:"Get",success:function(n){$("#divProration").html(n);$("#divProration").modal("show")}});else{var t=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:"../BudgetPlan/ClearProrationValues",type:"Post",data:{__RequestVerificationToken:t,isProration:"NO"},success:function(){$("#grdBudgetPlan").data("kendoGrid").dataSource.read();$("#idProrateTooltip").css("display","none");$("#proratedPopUp").hide()}})}});$(document).on("click","#prorationSave",function(){var n=$('input[name="__RequestVerificationToken"]').val(),t=$("#prorationStartDate").val(),i=$("#prorationEndDate").val(),r=$("#txtProrationDuration").val(),u=$("#txtProrationDays").val();$.ajax({url:"../BudgetPlan/_Proration",type:"Post",data:{__RequestVerificationToken:n,prorateStartDate:t,prorateEndDate:i,prorationDuration:r,prorationDays:u,prorationType:prorationType,isMerit:isMerit},success:function(){$("#divProration").modal("hide");isProrationVisible="True";$("#idProrateTooltip").css("display","inline");$("#proratedPopUp").show();$("#grdBudgetPlan").data("kendoGrid").dataSource.read();$("[id=txtAdjustedBudget]").attr("disabled",!1);$("[id=txtAdjustedBudgetPCT]").attr("disabled",!1);$("#prorateCheckBox").prop("checked",!0)}})});$(document).on("click","#budgetExport",function(){var i=$("#ddlLocalCurrenciesBudget").data("kendoDropDownList"),r=i.dataItem($("#ddlLocalCurrenciesBudget").data("kendoDropDownList").select()),t,n;selectedCurrencyCodeNum=$("#selectedCurrencyNum").val();selectedCurrencyCodeNum=selectedCurrencyCodeNum==0?r.CurrencyNum:selectedCurrencyCodeNum;t=$('input[name="__RequestVerificationToken"]').val();n=$("<form action='../BudgetPlan/BudgetPlanExport' method='post'><\/form>");n.append("<input type='text' name='__RequestVerificationToken' value='"+t+"' />");n.append("<input type='text' name='selectedCurrencyNum' value='"+selectedCurrencyCodeNum+"' />");n.appendTo("body");n.submit();n.remove()});$("#Budgetpercent").on("keypress",function(n){var r=$(this),t=n.which?n.which:event.keyCode,u,i,f;return t>31&&(t<48||t>57)&&t!=46?!1:(u=r.val().length,i=r.val().indexOf("."),i>0&&t==46)||i>0&&(f=u+1-i,f>3)?!1:r});$(document).on("click","#prorationCancel",function(){$("#divProration").modal("hide");isProrationVisible=="True"?$("#prorateCheckBox").prop("checked",!0):($("#prorateCheckBox").prop("checked",!1),$("#idProrateTooltip").css("display","none"),$("#proratedPopUp").hide())});isMerit=!1;$.validator.unobtrusive.adapters.add("notequalto",["other"],function(n){n.rules.notEqualTo="[name='"+n.params.other+"']";n.message&&(n.messages.notEqualTo=n.message)});$.validator.addMethod("notEqualTo",function(n,t,i){return this.optional(t)||n!=$(i).val()},"");$.validator.setDefaults({showErrors:function(n,t){return $.each(this.successList,function(n,t){return $(t).parent().removeClass("has-error"),$(t).popover("hide")}),$.each(t,function(n,t){var i;return i=$(t.element).popover({trigger:"manual",placement:"bottom",content:t.message,template:'<div class="popover"><div class="arrow"><\/div><div class="popover-inner"><div class="popover-content"><span class="glyphicon glyphicon-hand-right"><\/span><p><\/p><\/div><\/div><\/div>'}),$(t.element).parent().addClass("has-error"),i.data("bs.popover").options.content=t.message,$(t.element).popover("show")})}});$.validator.unobtrusive.adapters.add("notequalto",["other"],function(n){n.rules.notEqualTo="[name='"+n.params.other+"']";n.message&&(n.messages.notEqualTo=n.message)});$.validator.addMethod("notEqualTo",function(n,t,i){return this.optional(t)||n!=$(i).val()},"");$.validator.setDefaults({showErrors:function(n,t){return $.each(this.successList,function(n,t){return $(t).parent().removeClass("has-error"),$(t).popover("hide")}),$.each(t,function(n,t){var i;return i=$(t.element).popover({trigger:"manual",placement:"right",content:t.message,template:'<div class="popover"><div class="arrow"><\/div><div class="popover-inner"><div class="popover-content"><span class="glyphicon glyphicon-hand-right"><\/span><p><\/p><\/div><\/div><\/div>'}),$(t.element).parent().addClass("has-error"),i.data("bs.popover").options.content=t.message,$(t.element).popover("show")})}});$(document).on("keydown","#txtProrationDatesPerMonth",function(n){($("input:radio[name=duration]:checked").val()==undefined||$("input:radio[name=duration]:checked").val()=="")&&n.keyCode==9&&$(this).trigger("blur")});$(document).on("keydown","#txtProrationDuration",function(n){($("input:radio[name=duration]:checked").val()==undefined||$("input:radio[name=duration]:checked").val()=="")&&n.keyCode==9&&$(this).trigger("blur")});$(document).on("click","#txtProrationDuration",function(){var n,t;($("input:radio[name=duration]:checked").val()==undefined||$("input:radio[name=duration]:checked").val()=="")&&$(this).trigger("blur");n=$("#prorationStartDate").data("kendoDatePicker")._oldText;$("#processStartDateValue").val(n);t=$("#prorationEndDate").data("kendoDatePicker")._oldText;$("#processEndDateValue").val(t)});$(document).on("click","#txtProrationDatesPerMonth",function(){var n,t;($("input:radio[name=duration]:checked").val()==undefined||$("input:radio[name=duration]:checked").val()=="")&&$(this).trigger("blur");n=$("#prorationStartDate").data("kendoDatePicker")._oldText;$("#processStartDateValue").val(n);t=$("#prorationEndDate").data("kendoDatePicker")._oldText;$("#processEndDateValue").val(t)});$(document).on("change","#prorationDaily",function(){var t=$("#prorationStartDate").data("kendoDatePicker")._oldText,n;$("#processStartDateValue").val(t);n=$("#prorationEndDate").data("kendoDatePicker")._oldText;$("#processEndDateValue").val(n)});$(document).on("show.bs.modal","#divProration",function(){$.validator.unobtrusive.parse(document);setValidation();$("#txtProrationDatesPerMonth").keypress(function(n){return n.charCode>=48&&n.charCode<=57&&$("#datePerMonth").html(""),String.fromCharCode(n.keyCode).match(/[^0-9]/g)?!1:void 0});$("#txtProrationDuration").keypress(function(n){if(String.fromCharCode(n.keyCode).match(/[^0-9]/g))return!1})});$("#form").submit(function(){if($("#txtProrationDatesPerMonth").val()==""&&$("#prorationType").val()=="Monthly")return $("#datePerMonth").html("Please Enter Your Proration Dates Per Month"),!1});